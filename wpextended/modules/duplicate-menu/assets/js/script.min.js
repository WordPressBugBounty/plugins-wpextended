class DuplicateMenu{constructor(){this.duplicateButton=jQuery("#duplicate_menu"),this.selectedMenuField=jQuery("#selected_menu"),this.menuNameField=jQuery("#menu_name"),this.bindEvents()}bindEvents(){this.duplicateButton.on("click",(e=>this.handleDuplicate(e)))}handleDuplicate(e){e.preventDefault();const t=this.selectedMenuField.val(),n=this.menuNameField.val();this.validateFields(t,n)&&(this.setFieldsState(!0),this.duplicateMenu(t,n))}validateFields(e,t){return e?!!t||(window.notify.error(wpextDuplicateMenu.i18n.menu_name),!1):(window.notify.error(wpextDuplicateMenu.i18n.selected_menu),!1)}setFieldsState(e){this.duplicateButton.prop("disabled",e),this.selectedMenuField.prop("disabled",e),this.menuNameField.prop("disabled",e)}async duplicateMenu(e,t){try{const n=await fetch(wpextDuplicateMenu.restUrl,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":wpextDuplicateMenu.restNonce},body:JSON.stringify({menu_id:e,menu_name:t})});if(!n.ok){const e=await n.json();throw Error(e.message)}const i=await n.json();this.handleSuccess(i)}catch(e){this.handleError(e)}finally{this.setFieldsState(!1)}}handleSuccess(e){window.notify.success(`${e.message}<br>\n            <a href="${wpextDuplicateMenu.siteUrl}/wp-admin/nav-menus.php?action=edit&menu=${e.menu_id}">\n                ${wpextDuplicateMenu.i18n.view_menu}\n            </a>`,{duration:6e3}),this.clearForm(),this.selectedMenuField.append(`<option value="${e.menu_id}">${e.menu_name}</option>`)}handleError(e){window.notify.error(e.message)}clearForm(){this.menuNameField.val("")}}jQuery(document).ready((()=>{new DuplicateMenu}));